import { palettes } from './palettes.js';

//gs = global state, abbreviated for ease 
let gs={

    centerX :  window.innerWidth / 2,
    centerY :  window.innerHeight / 2,

    adjustingParameter : "none",
    numMorphSteps: 200,

    autoAdjustParams: true,
    rotation: 0,
    rotationSpeed: 0.001,
    colorChange: 10,
    numSpirals: 9, // Default number of spirals
    isBackgroundBlack: true, // default to black
    currentShapeIndex: 2, // index of shape type to default
    
    shapes : ["circle", "bm", "square", "triangle", "star", "rhombus", "heart", "flower", "soak", "rabbit", "random"],
    shape2Path: {
        'circle': `M 0 -0.5 L 0.35 -0.35 L 0.5 0 L 0.35 0.35 L 0 0.5 L -0.35 0.35 L -0.5 0 L -0.35 -0.35 Z`,
        'square': `M 0 -0.5 L 0.5 -0.5 L 0.5 0 L 0.5 0.5 L 0 0.5 L -0.5 0.5 L -0.5 0 L -0.5 -0.5 Z`,
        'triangle': `M -.5 .25 L 0 -.75 L .5 .25 L .3 .25 L .1 .25 L -.1 .25 L -.3 .25 L -.5 .25 Z`,
        'rhombus': `M 0 -0.5 L 0.4 -0.25 L 0.8 0 L 0.4 0.25 L 0 0.5 L -0.4 0.25 L -0.8 0 L -0.4 -0.25 Z`,
        'star': 'M -0 -0.4755 L 0.1648 -0.1766 L 0.5 -0.1123 L 0.2667 0.1369 L 0.309 0.4755 L -0 0.3306 L -0.309 0.4755 L -0.2667 0.1369 L -0.5 -0.1123 L -0.1648 -0.1766 L -0 -0.4755',
        'soak': 'M -0.5 0 C -0.5 -0.002 -0.5 -0.0041 -0.5 -0.0061 C -0.5001 -0.0333 -0.4979 -0.0613 -0.493 -0.0899 C -0.4801 -0.1737 -0.4543 -0.2323 -0.4543 -0.2323 C -0.4251 -0.3011 -0.3742 -0.3768 -0.3151 -0.4564 C -0.2759 -0.5093 -0.2377 -0.5604 -0.2032 -0.609 C -0.1349 -0.7045 -0.0812 -0.79 -0.0508 -0.8582 C -0.0088 -0.9459 -0.0015 -1.0048 0 -1.0204 C 0.0016 -1.0048 0.0089 -0.9459 0.0508 -0.8582 C 0.0813 -0.79 0.135 -0.7045 0.2033 -0.609 C 0.2378 -0.5604 0.276 -0.5093 0.3152 -0.4564 C 0.3743 -0.3768 0.4252 -0.3011 0.4544 -0.2323 V -0.2323 H 0.4544 C 0.4544 -0.2323 0.4803 -0.1737 0.4931 -0.0899 C 0.498 -0.0613 0.5002 -0.0333 0.5001 -0.0061 C 0.5001 -0.0041 0.5001 -0.002 0.5001 0 L 0.5 -0 C 0.4968 0.1591 0.4085 0.2908 0.2639 0.3619 C 0.2668 0.3594 0.2693 0.3567 0.2711 0.3538 C 0.285 0.3316 0.2952 0.3073 0.3021 0.2821 C 0.3168 0.2282 0.3159 0.1734 0.2923 0.1222 C 0.2705 0.0746 0.2236 0.0359 0.211 -0.0153 C 0.2049 -0.04 0.2117 -0.0666 0.2275 -0.0865 C 0.2439 -0.1072 0.2643 -0.105 0.2847 -0.1167 C 0.2392 -0.154 0.1821 -0.1589 0.1265 -0.1446 C 0.1404 -0.1908 0.1542 -0.2322 0.1484 -0.2812 C 0.1438 -0.3205 0.1281 -0.358 0.1017 -0.3876 C 0.0714 -0.4215 0.0297 -0.4439 -0.0156 -0.4487 C -0.0521 -0.4526 -0.1081 -0.4468 -0.135 -0.4185 C -0.0887 -0.4104 -0.0493 -0.3831 -0.0538 -0.3306 C -0.0587 -0.2737 -0.1024 -0.2308 -0.1379 -0.1902 C -0.2172 -0.0992 -0.3001 -0.0073 -0.3259 0.1143 C -0.3235 0.1031 -0.3222 0.0969 -0.3259 0.1144 C -0.3303 0.1352 -0.3319 0.143 -0.3321 0.1436 C -0.3318 0.1425 -0.3283 0.126 -0.3259 0.1145 C -0.3376 0.1699 -0.3326 0.2282 -0.3127 0.2811 C -0.3031 0.3063 -0.2903 0.3303 -0.2746 0.3522 C -0.2722 0.3555 -0.269 0.3585 -0.2653 0.3611 C -0.409 0.2899 -0.4967 0.1586 -0.4999 -0 L -0.5 0',
        'bm': "M -0.2073 0.4969 C -0.2237 0.4892 -0.2307 0.4697 -0.223 0.4533 L -0.223 0.4533 C -0.223 0.4533 -0.2211 0.4493 -0.2176 0.4415 L -0.2176 0.4415 C -0.2141 0.4337 -0.2091 0.4223 -0.203 0.408 L -0.203 0.408 C -0.1909 0.3793 -0.1747 0.339 -0.1586 0.293 L -0.1586 0.293 C -0.1263 0.2013 -0.0946 0.0856 -0.0948 -0.0027 L -0.0948 -0.0027 C -0.0948 -0.0121 -0.0951 -0.0212 -0.0959 -0.0298 L -0.0959 -0.0298 C -0.1016 -0.1036 -0.1439 -0.1962 -0.191 -0.2747 L -0.191 -0.2747 C -0.2379 -0.3533 -0.2887 -0.4186 -0.3086 -0.4433 L -0.3086 -0.4433 C -0.3143 -0.4503 -0.3173 -0.4539 -0.3173 -0.4539 L -0.3173 -0.4539 C -0.329 -0.4677 -0.3272 -0.4883 -0.3134 -0.5 L -0.3134 -0.5 C -0.2996 -0.5117 -0.279 -0.5099 -0.2673 -0.4961 L -0.2673 -0.4961 C -0.2667 -0.4954 -0.2126 -0.4314 -0.156 -0.3426 L -0.156 -0.3426 C -0.0997 -0.2534 -0.0399 -0.1408 -0.0307 -0.0352 L -0.0307 -0.0352 C -0.0298 -0.0245 -0.0294 -0.0137 -0.0294 -0.0027 L -0.0294 -0.0027 C -0.0296 0.1 -0.0636 0.2192 -0.0969 0.3147 L -0.0969 0.3147 C -0.1303 0.4099 -0.1635 0.4805 -0.1638 0.4812 L -0.1638 0.4812 C -0.1694 0.4931 -0.1811 0.5 -0.1934 0.5 L -0.1934 0.5 C -0.1981 0.5 -0.2028 0.499 -0.2073 0.4969 L -0.2073 0.4969 Z M 0.1638 0.4812 C 0.1635 0.4805 0.1303 0.4099 0.0969 0.3147 L 0.0969 0.3147 C 0.0636 0.2192 0.0296 0.1 0.0293 -0.0027 L 0.0293 -0.0027 C 0.0293 -0.0137 0.0298 -0.0246 0.0306 -0.0352 L 0.0306 -0.0352 C 0.0399 -0.1408 0.0997 -0.2534 0.156 -0.3426 L 0.156 -0.3426 C 0.2126 -0.4314 0.2667 -0.4954 0.2673 -0.4961 L 0.2673 -0.4961 L 0.2673 -0.4961 C 0.279 -0.5099 0.2996 -0.5117 0.3134 -0.5 L 0.3134 -0.5 C 0.3272 -0.4883 0.329 -0.4677 0.3173 -0.4539 L 0.3173 -0.4539 C 0.3173 -0.4539 0.3143 -0.4503 0.3086 -0.4432 L 0.3086 -0.4432 C 0.3029 -0.4362 0.2947 -0.4258 0.2848 -0.4128 L 0.2848 -0.4128 C 0.2649 -0.3867 0.2383 -0.3499 0.2112 -0.3075 L 0.2112 -0.3075 C 0.157 -0.2229 0.1023 -0.1143 0.0959 -0.0298 L 0.0959 -0.0298 C 0.0951 -0.0211 0.0948 -0.012 0.0948 -0.0027 L 0.0948 -0.0027 C 0.0946 0.0744 0.1188 0.1729 0.1466 0.2576 L 0.1466 0.2576 C 0.1743 0.3424 0.2053 0.4142 0.2176 0.4415 L 0.2176 0.4415 C 0.2211 0.4493 0.223 0.4533 0.223 0.4533 L 0.223 0.4533 C 0.2307 0.4697 0.2237 0.4892 0.2073 0.4969 L 0.2073 0.4969 C 0.2028 0.499 0.1981 0.5 0.1934 0.5 L 0.1934 0.5 C 0.1811 0.5 0.1694 0.493 0.1638 0.4812 L 0.1638 0.4812 Z M -0.0284 -0.2172 L -0.1163 -0.3711 C -0.1239 -0.3844 -0.1213 -0.4011 -0.11 -0.4114 L -0.11 -0.4114 L -0.0221 -0.492 C -0.0096 -0.5035 0.0096 -0.5035 0.0221 -0.492 L 0.0221 -0.492 L 0.11 -0.4114 C 0.1213 -0.4011 0.1239 -0.3844 0.1163 -0.3711 L 0.1163 -0.3711 L 0.0284 -0.2172 C 0.0226 -0.2071 0.0117 -0.2007 -0 -0.2007 L -0 -0.2007 C -0.0117 -0.2007 -0.0226 -0.2071 -0.0284 -0.2172 L -0.0284 -0.2172 Z M -0.0465 -0.3808 L -0 -0.2994 L 0.0465 -0.3808 L -0 -0.4235 L -0.0465 -0.3808 L -0.0465 -0.3808 Z",
        'rabbit': "M 0.4766 0.2727 C 0.4349 0.2238 0.4346 0.1519 0.3916 0.1536 C 0.3627 0.1547 0.3416 0.0953 0.3309 0.0562 C 0.3314 0.0476 0.3312 0.0396 0.3299 0.0318 C 0.3577 0.0357 0.3857 0.0207 0.3972 -0.0063 C 0.4109 -0.0387 0.4058 -0.1346 0.3634 -0.0898 S 0.2937 -0.0883 0.28 -0.0559 C 0.2775 -0.05 0.2759 -0.0439 0.2754 -0.0378 C 0.2483 -0.0528 0.2119 -0.0638 0.1668 -0.0715 C 0.0239 -0.0961 -0.1191 -0.1903 -0.1663 -0.2236 C -0.1638 -0.2328 -0.1628 -0.2423 -0.1638 -0.252 C -0.1232 -0.2477 -0.0569 -0.2531 0.0026 -0.2716 C 0.0934 -0.2999 0.0668 -0.3187 0.154 -0.3187 C 0.2508 -0.3283 0.0696 -0.3849 -0.0204 -0.3671 C 0.0489 -0.413 0.1055 -0.3671 0.1637 -0.4252 C 0.0403 -0.4863 -0.0332 -0.4568 -0.1114 -0.4025 C -0.1488 -0.3765 -0.1806 -0.3496 -0.2021 -0.3265 C -0.2335 -0.3521 -0.2796 -0.3577 -0.3304 -0.3574 C -0.3433 -0.3509 -0.3562 -0.3445 -0.3691 -0.3283 C -0.3982 -0.309 -0.4757 -0.2605 -0.4466 -0.2218 C -0.4356 -0.1892 -0.3767 -0.1344 -0.3081 -0.133 C -0.3026 -0.1208 -0.2949 -0.1053 -0.2845 -0.0876 C -0.3227 -0.0885 -0.4509 -0.0912 -0.4735 -0.0888 C -0.5 -0.086 -0.4784 -0.0471 -0.4475 -0.0369 C -0.4166 -0.0266 -0.3716 -0.0398 -0.3316 -0.0174 C -0.282 0.0103 -0.2224 0.0248 -0.1891 0.0311 C -0.1492 0.0683 -0.0983 0.1041 -0.0341 0.1309 C 0.0539 0.1677 0.1055 0.156 0.1734 0.1463 C 0.203 0.1986 0.2507 0.2288 0.3491 0.2173 C 0.3491 0.2173 0.3748 0.2198 0.4335 0.3377 C 0.4557 0.3822 0.5 0.3306 0.4766 0.2727 H 0.4765 Z",
        'heart' : "M 0.3112 -0.2397 C 0.2284 -0.3102 0.1053 -0.2975 0.0294 -0.2192 L -0.0004 -0.1885 L -0.0301 -0.2192 C -0.106 -0.2975 -0.2292 -0.3102 -0.312 -0.2397 C -0.4068 -0.1587 -0.4118 -0.0134 -0.3269 0.0743 L -0.0347 0.3761 C 0 0.4123 0 0.4123 0.0338 0.3761 L 0.326 0.0743 C 0.411 -0.0134 0.4061 -0.1587 0.3112 -0.2397 Z",
        'flower': "M 0.6565 -0.1714 C 0.6534 -0.1714 0.6493 -0.1724 0.6462 -0.1714 C 0.611 -0.1631 0.5758 -0.1652 0.5416 -0.1735 C 0.5116 -0.1807 0.4826 -0.1869 0.4525 -0.1952 C 0.3604 -0.2211 0.2713 -0.2118 0.1843 -0.1703 C 0.174 -0.1652 0.1647 -0.1569 0.1522 -0.1569 C 0.1429 -0.1693 0.1502 -0.1817 0.1522 -0.1931 C 0.1667 -0.2863 0.147 -0.3733 0.0973 -0.4531 C 0.0839 -0.4738 0.0704 -0.4945 0.057 -0.5152 C 0.0321 -0.5545 0.0124 -0.5949 0.0083 -0.6426 C 0.0083 -0.6457 0.0062 -0.6488 0.0052 -0.6519 C 0.0031 -0.6508 0.0021 -0.6508 0.001 -0.6498 C -0.001 -0.6436 -0.0041 -0.6363 -0.0041 -0.6291 C -0.0072 -0.5887 -0.0249 -0.5545 -0.0456 -0.5214 C -0.0611 -0.4965 -0.0777 -0.4717 -0.0932 -0.4468 C -0.1408 -0.3702 -0.1574 -0.2863 -0.146 -0.1962 C -0.145 -0.1848 -0.1367 -0.1714 -0.1491 -0.1641 C -0.1584 -0.159 -0.1688 -0.1693 -0.1781 -0.1735 C -0.2672 -0.2138 -0.3583 -0.2252 -0.4525 -0.1962 C -0.4753 -0.189 -0.4981 -0.1848 -0.5209 -0.1786 C -0.5613 -0.1683 -0.6017 -0.1662 -0.6431 -0.1745 C -0.6483 -0.1755 -0.6545 -0.1786 -0.6596 -0.1745 C -0.6596 -0.1641 -0.6493 -0.1621 -0.6431 -0.159 C -0.611 -0.1434 -0.5841 -0.1206 -0.5613 -0.0937 C -0.5437 -0.073 -0.5261 -0.0523 -0.5095 -0.0316 C -0.4484 0.0502 -0.3666 0.0958 -0.2682 0.1134 C -0.261 0.1144 -0.2547 0.1165 -0.2475 0.1186 C -0.2423 0.1206 -0.2402 0.1258 -0.2444 0.13 C -0.2496 0.1362 -0.2558 0.1424 -0.261 0.1476 C -0.3148 0.2025 -0.3511 0.2677 -0.3645 0.3443 C -0.3707 0.3806 -0.3738 0.4168 -0.3749 0.4531 C -0.3769 0.5059 -0.3852 0.5556 -0.4132 0.6011 C -0.4153 0.6042 -0.4194 0.6094 -0.4111 0.6136 C -0.408 0.6105 -0.4039 0.6084 -0.4008 0.6053 C -0.3749 0.5711 -0.3397 0.5514 -0.3013 0.5359 C -0.2734 0.5245 -0.2444 0.5131 -0.2164 0.5017 C -0.1284 0.4665 -0.0642 0.4054 -0.0207 0.3215 C -0.0166 0.3133 -0.0145 0.3039 -0.0052 0.2988 C 0.0041 0.3039 0.0052 0.3143 0.0093 0.3215 C 0.0394 0.3754 0.0756 0.4241 0.1274 0.4603 C 0.1522 0.4779 0.1792 0.4924 0.2081 0.5038 C 0.2361 0.5152 0.2651 0.5266 0.2931 0.538 C 0.3293 0.5525 0.3635 0.5711 0.3883 0.6032 C 0.3925 0.6074 0.3966 0.6115 0.4008 0.6156 C 0.4028 0.6177 0.407 0.6198 0.4101 0.6167 C 0.4111 0.6156 0.4111 0.6125 0.4101 0.6105 C 0.407 0.6042 0.4039 0.598 0.3997 0.5918 C 0.3811 0.5639 0.3728 0.5318 0.3697 0.4986 C 0.3666 0.4644 0.3635 0.4303 0.3624 0.3971 C 0.3614 0.3371 0.3428 0.2812 0.3138 0.2294 C 0.2972 0.1993 0.2744 0.1735 0.2516 0.1486 C 0.2485 0.1455 0.2454 0.1424 0.2413 0.1382 C 0.2382 0.1351 0.234 0.132 0.2361 0.1269 C 0.2382 0.1217 0.2434 0.1217 0.2485 0.1217 C 0.3542 0.1082 0.4391 0.0595 0.5054 -0.0243 C 0.5167 -0.0388 0.5281 -0.0544 0.5406 -0.0689 C 0.5716 -0.1061 0.6037 -0.1424 0.6514 -0.159 C 0.6534 -0.16 0.6555 -0.161 0.6576 -0.1631 C 0.6586 -0.1641 0.6596 -0.1672 0.6596 -0.1693 C 0.6596 -0.1703 0.6576 -0.1714 0.6565 -0.1714 Z"
    },
        

    extraRotation: {
        'circle': 0,
        'square': 45,
        'triangle': -90,
        'rhombus': 0,
        'star':0,
        'soak':90,
        'bm':90,
        'rabbit':90,
        'heart':90,
        'flower':90
    },

    dotShapeMemory: {},

    time: 0,
    frequency: 0,
    oscillationRange: 100,
    minDotSize: 50,
    maxDotSize: 66,
    phase: 0,

    colorModes: ["default", "offsetAngle", "offsetAndRadius", "radiusBased", "hueSliceByOffsetAndRadius", "grayscale_hsl", "constantHue", "palette"],
    colorModeIndex: 7, // global variable to track the current color mode

    baseHue: 200,  //Hue for hueSlice color modes
    hueRange: 50,  //Width of hue slice 

    currentPalette: 0,
    doDisplayControls: false, // Whether or not the control display is visible
    angleIncrement: -0.03,
    radiusIncrement: 10,
    r0: 84.35, // Adjust this for the inflection point of the curve
    k: 0.034, // Adjust this to make the transition smoother

    transitionStartTime: null,
    transitionDuration : 5000 //Color transition time in milliseconds
}

function initializeValues(){
    gs.currentShape = gs.shapes[gs.currentShapeIndex] // Depends on 'shapes' and 'currentShapeIndex'
    gs.lastShape = gs.shapes[gs.currentShapeIndex] // Depends on 'shapes' and 'currentShapeIndex'
    gs.nextColorModeIndex = (gs.colorModeIndex)
    gs.nextPalette = (gs.currentPalette);
    gs.colorMethod = gs.colorModes[gs.colorModeIndex];
    gs.maxRadius = Math.sqrt(gs.centerX ** 2 + gs.centerY ** 2)
}

initializeValues()

export { gs }